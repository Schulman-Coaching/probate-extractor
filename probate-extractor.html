<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Probate Extractor | Death Certificate Analysis</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'DM Sans', system-ui, sans-serif; background: linear-gradient(180deg, #FAF8F3 0%, #F5F0E6 100%); }
    h1, h2, h3, h4 { font-family: 'Playfair Display', Georgia, serif; }
    .mono { font-family: 'JetBrains Mono', monospace; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .animate-spin { animation: spin 1s linear infinite; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useCallback, useRef } = React;

    // SVG Icons
    const Scale = ({ className }) => (
      <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M16 16l3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="M2 16l3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/>
        <path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/>
      </svg>
    );
    const Upload = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>);
    const FileText = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>);
    const CheckCircle = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>);
    const AlertCircle = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>);
    const Download = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>);
    const ChevronDown = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="6 9 12 15 18 9"/></svg>);
    const ChevronRight = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="9 18 15 12 9 6"/></svg>);
    const Loader2 = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>);
    const Info = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>);
    const FileSearch = ({ className }) => (<svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v3"/><polyline points="14 2 14 8 20 8"/><circle cx="5" cy="14" r="3"/><path d="m9 18-1.5-1.5"/></svg>);

    const DEMO_RESULT = {
      extraction_timestamp: new Date().toISOString(),
      source_document_type: "Death Certificate",
      probate_petition_fields: {
        form_p1_section_2: {
          "2a_decedent_name": "Lillian Herman Klein",
          "2a_aka": "Lillian Herman",
          "2b_date_of_death": "11/24/1975",
          "2c_place_of_death": "Brooklyn, Kings County, New York",
          "2d_domicile_street": "1456 East 94th Street",
          "2d_domicile_city_town_village": "Brooklyn",
          "2d_domicile_county": "Kings",
          "2d_domicile_state": "New York",
          "2e_citizenship": "United States of America"
        },
        family_information: { marital_status: "Widowed", spouse_name: "Jacob Klein (deceased)", father_name: "Samuel Wolf Herman", mother_name: "" },
        reference_information: { certificate_number: "156-75-319029", date_of_birth: "", age_at_death: "78" }
      },
      preparation_checklist: [
        { item: "Certified death certificate", form_reference: "P-CHKLST ¶2(b)", status: "REQUIRED", note: "Must be certified copy filed with petition" },
        { item: "Verify decedent name matches Will signature", form_reference: "P-CHKLST ¶2(a)", status: "VERIFY", note: "AKAs found: Lillian Herman" },
        { item: "Venue: Kings County Surrogate's Court", form_reference: "P-CHKLST ¶2(d)", status: "VERIFIED", note: "Confirm domicile matches death certificate" },
        { item: "Date of death: 11/24/1975", form_reference: "P-CHKLST ¶2(b)", status: "VERIFIED", note: "Must match death certificate exactly" },
        { item: "Decedent citizenship", form_reference: "P-CHKLST ¶2(e)", status: "COMPLETE", note: "United States of America" },
        { item: "Identify all distributees", form_reference: "P-CHKLST ¶5, ¶6", status: "REQUIRED", note: "Marital status: Widowed" }
      ],
      notes: ["AKA names found: Lillian Herman", "Probate venue should be Kings County Surrogate's Court"],
      next_steps: ["Verify decedent name matches Will signature exactly", "Confirm domicile to establish proper venue", "Obtain original Will and any Codicils", "Identify all distributees", "Prepare Petition for Probate (Form P-1)", "Obtain Affidavit of Attesting Witness (Form P-3)", "Prepare Waivers (Form P-4) or Citations (Form P-5)"]
    };

    function StatusBadge({ status }) {
      const styles = {
        VERIFIED: 'bg-emerald-50 text-emerald-700 border-emerald-200',
        COMPLETE: 'bg-emerald-50 text-emerald-700 border-emerald-200',
        REQUIRED: 'bg-rose-50 text-rose-700 border-rose-200',
        VERIFY: 'bg-amber-50 text-amber-700 border-amber-200'
      };
      return <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold uppercase tracking-wide border ${styles[status] || styles.VERIFY}`}>{status}</span>;
    }

    function FieldDisplay({ label, value, formRef }) {
      if (!value) return null;
      return (
        <div className="mb-4">
          <div className="flex items-center gap-2 mb-1">
            <span className="text-xs uppercase tracking-wider text-slate-500 font-semibold">{label}</span>
            {formRef && <span className="mono text-xs bg-amber-50 text-amber-700 px-2 py-0.5 rounded">{formRef}</span>}
          </div>
          <div className="mono text-slate-900">{value}</div>
        </div>
      );
    }

    function CollapsibleSection({ title, icon: Icon, children, defaultOpen = true }) {
      const [isOpen, setIsOpen] = useState(defaultOpen);
      return (
        <div className="bg-white rounded-lg shadow-sm border border-slate-200 mb-4 overflow-hidden">
          <button onClick={() => setIsOpen(!isOpen)} className="w-full flex items-center justify-between p-4 hover:bg-slate-50 transition-colors">
            <div className="flex items-center gap-3">
              <Icon className="w-5 h-5 text-rose-800" />
              <h3 className="text-lg font-semibold text-slate-900">{title}</h3>
            </div>
            {isOpen ? <ChevronDown className="w-5 h-5 text-slate-500" /> : <ChevronRight className="w-5 h-5 text-slate-500" />}
          </button>
          {isOpen && <div className="px-4 pb-4 border-t border-slate-100">{children}</div>}
        </div>
      );
    }

    function App() {
      const [file, setFile] = useState(null);
      const [isDragging, setIsDragging] = useState(false);
      const [isProcessing, setIsProcessing] = useState(false);
      const [result, setResult] = useState(null);
      const [error, setError] = useState(null);
      const fileInputRef = useRef(null);

      const handleDragOver = useCallback((e) => { e.preventDefault(); setIsDragging(true); }, []);
      const handleDragLeave = useCallback((e) => { e.preventDefault(); setIsDragging(false); }, []);
      const handleDrop = useCallback((e) => {
        e.preventDefault(); setIsDragging(false);
        const droppedFile = e.dataTransfer.files[0];
        if (droppedFile && (droppedFile.type === 'application/pdf' || droppedFile.type.startsWith('image/'))) {
          setFile(droppedFile); setError(null);
        } else { setError('Please upload a PDF or image file'); }
      }, []);
      const handleFileSelect = useCallback((e) => { if (e.target.files?.[0]) { setFile(e.target.files[0]); setError(null); } }, []);
      const processFile = async () => { setIsProcessing(true); await new Promise(r => setTimeout(r, 2500)); setResult(DEMO_RESULT); setIsProcessing(false); };
      const downloadJSON = () => {
        const blob = new Blob([JSON.stringify(result, null, 2)], { type: 'application/json' });
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'probate_extraction.json'; a.click();
      };
      const resetForm = () => { setFile(null); setResult(null); setError(null); };

      return (
        <div className="min-h-screen">
          <header className="border-b border-amber-200/50 bg-white/70 backdrop-blur-sm sticky top-0 z-50">
            <div className="max-w-6xl mx-auto px-6 py-4 flex items-center gap-4">
              <div className="p-2 bg-rose-800/10 rounded-lg"><Scale className="w-8 h-8 text-rose-800" /></div>
              <div>
                <h1 className="text-2xl font-bold text-slate-900">Probate Extractor</h1>
                <p className="text-sm text-slate-600">Death Certificate Analysis for NY Surrogate's Court</p>
              </div>
            </div>
          </header>

          <div className="max-w-6xl mx-auto px-6 py-8">
            {!result && (
              <>
                <div className="text-center mb-12">
                  <h2 className="text-4xl font-bold text-slate-900 mb-4">Extract Probate-Ready Data</h2>
                  <p className="text-lg text-slate-600 max-w-2xl mx-auto">Upload a death certificate to automatically extract and map information to NY Surrogate's Court Form P-1.</p>
                </div>
                <div className="max-w-2xl mx-auto mb-8">
                  <div className={`rounded-lg p-12 text-center cursor-pointer border-2 border-dashed transition-all ${isDragging ? 'border-rose-800 bg-rose-50/50' : 'border-amber-300 hover:border-rose-800 bg-gradient-to-br from-amber-50/50 to-rose-50/30'}`}
                    onDragOver={handleDragOver} onDragLeave={handleDragLeave} onDrop={handleDrop} onClick={() => fileInputRef.current?.click()}>
                    <input ref={fileInputRef} type="file" accept=".pdf,image/*" onChange={handleFileSelect} className="hidden" />
                    {file ? (
                      <div className="space-y-4">
                        <div className="inline-flex items-center justify-center w-16 h-16 bg-rose-800/10 rounded-full"><FileText className="w-8 h-8 text-rose-800" /></div>
                        <div><p className="font-semibold text-slate-900">{file.name}</p><p className="text-sm text-slate-500">{(file.size / 1024).toFixed(1)} KB</p></div>
                      </div>
                    ) : (
                      <div className="space-y-4">
                        <div className="inline-flex items-center justify-center w-16 h-16 bg-amber-100 rounded-full"><Upload className="w-8 h-8 text-amber-700" /></div>
                        <div><p className="font-semibold text-slate-900">Drop your death certificate here</p><p className="text-sm text-slate-500">or click to browse • PDF or Image files</p></div>
                      </div>
                    )}
                  </div>
                  {error && <div className="mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3"><AlertCircle className="w-5 h-5 text-red-500" /><p className="text-red-700">{error}</p></div>}
                  {file && !isProcessing && (
                    <div className="mt-6 flex justify-center gap-4">
                      <button onClick={resetForm} className="px-6 py-3 rounded-lg font-semibold border-2 border-slate-900 text-slate-900 hover:bg-slate-900 hover:text-white transition-colors">Clear</button>
                      <button onClick={processFile} className="px-6 py-3 rounded-lg font-semibold bg-rose-800 text-white hover:bg-rose-900 transition-colors flex items-center gap-2"><FileSearch className="w-5 h-5" />Extract Data</button>
                    </div>
                  )}
                  {isProcessing && (
                    <div className="mt-8 text-center space-y-4">
                      <div className="flex items-center justify-center gap-2"><Loader2 className="w-5 h-5 animate-spin text-rose-800" /><span className="text-slate-900 font-medium">Analyzing document...</span></div>
                    </div>
                  )}
                </div>
              </>
            )}

            {result && (
              <>
                <div className="flex items-center justify-between mb-8 flex-wrap gap-4">
                  <div className="flex items-center gap-3">
                    <div className="p-2 bg-emerald-100 rounded-full"><CheckCircle className="w-6 h-6 text-emerald-600" /></div>
                    <div><h2 className="text-2xl font-bold text-slate-900">Extraction Complete</h2><p className="text-sm text-slate-500">Processed: {file?.name}</p></div>
                  </div>
                  <div className="flex gap-3">
                    <button onClick={resetForm} className="px-4 py-2 rounded-lg font-semibold border-2 border-slate-900 text-slate-900 hover:bg-slate-900 hover:text-white transition-colors text-sm">New Extraction</button>
                    <button onClick={downloadJSON} className="px-4 py-2 rounded-lg font-semibold bg-rose-800 text-white hover:bg-rose-900 transition-colors flex items-center gap-2 text-sm"><Download className="w-4 h-4" />Download JSON</button>
                  </div>
                </div>
                <div className="grid lg:grid-cols-2 gap-6">
                  <div>
                    <CollapsibleSection title="Form P-1 Section 2" icon={FileText}>
                      <div className="pt-4 grid grid-cols-2 gap-x-6">
                        <div className="col-span-2"><FieldDisplay label="Decedent Name" value={result.probate_petition_fields.form_p1_section_2["2a_decedent_name"]} formRef="¶2(a)" /></div>
                        <div className="col-span-2"><FieldDisplay label="A/K/A" value={result.probate_petition_fields.form_p1_section_2["2a_aka"]} formRef="¶2(a)" /></div>
                        <FieldDisplay label="Date of Death" value={result.probate_petition_fields.form_p1_section_2["2b_date_of_death"]} formRef="¶2(b)" />
                        <FieldDisplay label="Place of Death" value={result.probate_petition_fields.form_p1_section_2["2c_place_of_death"]} formRef="¶2(c)" />
                        <div className="col-span-2 mt-2 pt-4 border-t border-slate-100"><p className="text-xs uppercase tracking-wider text-slate-500 font-semibold mb-3">Domicile <span className="mono text-xs bg-amber-50 text-amber-700 px-2 py-0.5 rounded ml-2">¶2(d)</span></p></div>
                        <div className="col-span-2"><FieldDisplay label="Street" value={result.probate_petition_fields.form_p1_section_2["2d_domicile_street"]} /></div>
                        <FieldDisplay label="City" value={result.probate_petition_fields.form_p1_section_2["2d_domicile_city_town_village"]} />
                        <FieldDisplay label="County" value={result.probate_petition_fields.form_p1_section_2["2d_domicile_county"]} />
                        <FieldDisplay label="State" value={result.probate_petition_fields.form_p1_section_2["2d_domicile_state"]} />
                        <FieldDisplay label="Citizenship" value={result.probate_petition_fields.form_p1_section_2["2e_citizenship"]} formRef="¶2(e)" />
                      </div>
                    </CollapsibleSection>
                    <CollapsibleSection title="Family Information" icon={Scale} defaultOpen={false}>
                      <div className="pt-4 grid grid-cols-2 gap-x-6">
                        <FieldDisplay label="Marital Status" value={result.probate_petition_fields.family_information.marital_status} />
                        <FieldDisplay label="Spouse Name" value={result.probate_petition_fields.family_information.spouse_name} />
                        <FieldDisplay label="Father's Name" value={result.probate_petition_fields.family_information.father_name} />
                      </div>
                    </CollapsibleSection>
                  </div>
                  <div>
                    <CollapsibleSection title="Preparation Checklist" icon={CheckCircle}>
                      <div className="pt-2">
                        {result.preparation_checklist.map((item, idx) => (
                          <div key={idx} className="flex items-start gap-3 py-3 border-b border-slate-100 last:border-0">
                            <div className="flex-shrink-0 mt-0.5">
                              {['VERIFIED','COMPLETE'].includes(item.status) ? <CheckCircle className="w-5 h-5 text-emerald-500" /> : <div className="w-5 h-5 rounded-full border-2 border-amber-400" />}
                            </div>
                            <div className="flex-grow">
                              <div className="flex items-center gap-2 mb-1 flex-wrap"><span className="font-medium text-slate-900">{item.item}</span><StatusBadge status={item.status} /></div>
                              <div className="mono text-xs bg-amber-50 text-amber-700 px-2 py-0.5 rounded inline-block mb-1">{item.form_reference}</div>
                              {item.note && <p className="text-sm text-slate-600">{item.note}</p>}
                            </div>
                          </div>
                        ))}
                      </div>
                    </CollapsibleSection>
                    <CollapsibleSection title="Next Steps" icon={FileSearch} defaultOpen={false}>
                      <ol className="pt-4 space-y-3">
                        {result.next_steps.map((step, idx) => (
                          <li key={idx} className="flex items-start gap-3 text-sm">
                            <span className="flex-shrink-0 w-6 h-6 rounded-full bg-rose-800/10 text-rose-800 font-semibold flex items-center justify-center text-xs">{idx + 1}</span>
                            <span className="text-slate-900 pt-0.5">{step}</span>
                          </li>
                        ))}
                      </ol>
                    </CollapsibleSection>
                  </div>
                </div>
              </>
            )}

            <footer className="mt-16 pt-8 border-t border-amber-200/50">
              <div className="text-center mb-6"><h3 className="text-lg font-semibold text-slate-900 mb-2">Supported NY Surrogate's Court Forms</h3></div>
              <div className="grid grid-cols-3 md:grid-cols-6 gap-4">
                {[{id:'P-1',name:'Petition'},{id:'P-3',name:'Affidavit'},{id:'P-4',name:'Waiver'},{id:'P-5',name:'Citation'},{id:'P-6',name:'Notice'},{id:'CHKLST',name:'Checklist'}].map(f => (
                  <div key={f.id} className="bg-white rounded-lg shadow-sm border border-slate-200 p-3 text-center">
                    <div className="mono text-lg font-bold text-rose-800">{f.id}</div>
                    <div className="text-xs text-slate-600">{f.name}</div>
                  </div>
                ))}
              </div>
              <p className="mt-8 text-center text-xs text-slate-500">For informational purposes only. Consult an attorney.</p>
            </footer>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
